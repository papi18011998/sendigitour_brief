/*!
 * 
 * Presto Player
 * 
 * @author Presto Made, Inc
 * @version 0.1.0
 * @link undefined
 * @license GPL
 * 
 * Copyright (c) 2022 Presto Made, Inc
 * 
 * This software is released under the GPL License
 * https://opensource.org/licenses/GPL
 * 
 * Compiled with the help of https://wpack.io
 * A zero setup Webpack Bundler Script for WordPress
 */
(window.wpackioprestoPlayerdiviJsonp=window.wpackioprestoPlayerdiviJsonp||[]).push([[0],{0:function(e,t){e.exports=React},25:function(e,t){e.exports=ReactDOM},41:function(e,t){e.exports=jQuery},51:function(e,t,n){n(52),e.exports=n(69)},69:function(e,t,n){"use strict";n.r(t);var r=n(41),o=n.n(r),a=n(7),c=n(8),i=n(9),s=n(27),u=n(20),l=n(4),p=n(0),f=n.n(p),d=n(28),b=n(29),v=n(18),h=n(21),O=n.n(h),m=n(42),y=n(43),j=n(49),w=n(50),_=n(36),g=function(e){return e.replace(/([A-Z])/g,(function(e){return"-".concat(e[0].toLowerCase())}))},E=n(45),C=function(e,t,n){var r=t.className||t.class,o=n.className||n.class,a=x(e),c=x(r?r.split(" "):[]),i=x(o?o.split(" "):[]),s=[];return a.forEach((function(e){c.has(e)?(s.push(e),c.delete(e)):i.has(e)||s.push(e)})),c.forEach((function(e){return s.push(e)})),s.join(" ")},k=function(e){if("undefined"==typeof document)return!0;var t="on"+e,n=t in document;if(!n){var r=document.createElement("div");r.setAttribute(t,"return;"),n="function"==typeof r[t]}return n},R=function(e,t,n){var r=e.__events||(e.__events={}),o=r[t];o&&e.removeEventListener(t,o),e.addEventListener(t,r[t]=function(e){n&&n.call(this,e)})},x=function(e){var t=new Map;return e.forEach((function(e){return t.set(e,e)})),t},P=function(e,t){"function"==typeof e?e(t):null!=e&&(e.current=t)},V=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return function(e){t.forEach((function(t){P(t,e)}))}};function S(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Object(_.a)(e);if(t){var o=Object(_.a)(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Object(w.a)(this,n)}}var L,N=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(r=Object.getOwnPropertySymbols(e);o<r.length;o++)t.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(e,r[o])&&(n[r[o]]=e[r[o]])}return n},D=function(e,t,n,r){void 0!==r&&r();var o=e.toLowerCase().split("-").map((function(e){return e.charAt(0).toUpperCase()+e.slice(1)})).join(""),a=function(t){Object(j.a)(a,t);var r=S(a);function a(e){var t;return Object(m.a)(this,a),(t=r.call(this,e)).setComponentElRef=function(e){t.componentEl=e},t}return Object(y.a)(a,[{key:"componentDidMount",value:function(){this.componentDidUpdate(this.props)}},{key:"componentDidUpdate",value:function(e){!function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(e instanceof Element){var r=C(e.classList,t,n);""!==r&&(e.className=r),Object.keys(t).forEach((function(n){if("children"!==n&&"style"!==n&&"ref"!==n&&"class"!==n&&"className"!==n&&"forwardedRef"!==n)if(0===n.indexOf("on")&&n[2]===n[2].toUpperCase()){var r=n.substring(2),o=r[0].toLowerCase()+r.substring(1);k(o)||R(e,o,t[n])}else{e[n]=t[n],"string"===Object(E.a)(t[n])&&e.setAttribute(g(n),t[n])}}))}}(this.componentEl,this.props,e)}},{key:"render",value:function(){var t=this.props,r=t.children,o=t.forwardedRef,a=t.style,c=(t.className,t.ref,N(t,["children","forwardedRef","style","className","ref"])),i=Object.keys(c).reduce((function(e,t){if(0===t.indexOf("on")&&t[2]===t[2].toUpperCase()){var n=t.substring(2).toLowerCase();"undefined"!=typeof document&&k(n)&&(e[t]=c[t])}else e[t]=c[t];return e}),{});n&&(i=n(this.props,i));var s=Object.assign(Object.assign({},i),{ref:V(o,this.setComponentElRef),style:a});return f.a.createElement(e,s,r)}}],[{key:"displayName",get:function(){return o}}]),a}(f.a.Component);return t&&(a.contextType=t),function(e,t){var n=function(t,n){return f.a.createElement(e,Object.assign({},t,{forwardedRef:n}))};return n.displayName=t,f.a.forwardRef(n)}(a,o)},I=D("presto-player"),T=n(12);var A=function(e){var t=e.id,n=e.src,r=Object(p.useState)({}),o=Object(v.a)(r,2),a=o[0],c=o[1],i=Object(p.useState)(!1),s=Object(v.a)(i,2),u=s[0],l=s[1],f=Object(p.useState)(""),h=Object(v.a)(f,2),m=h[0],y=h[1],j=Object(p.useState)(1),w=Object(v.a)(j,2),_=w[0],g=w[1];Object(p.useEffect)((function(){g(_+1)}),[t,n,a]),Object(p.useEffect)((function(){k(t)}),[t]),Object(p.useEffect)((function(){n&&y(function(e){if(e){if(e.includes(".mp3"))return"audio";if(e.match(/^(?:https?:\/\/)?(?:www\.)?(?:youtu\.be\/|youtube\.com\/(?:embed\/|v\/|watch\?v=|watch\?.+&v=))((\w|-){11})(?:\S+)?$/))return"youtube";if(e.match(/(https?:\/\/)?(www\.)?(player\.)?vimeo\.com\/([a-z]*\/)*([‌​0-9]{6,11})[?]?.*/))return"vimeo";if(e.indexOf("https://vz-")>-1&&e.indexOf("b-cdn.net")>-1)return"bunny"}return"self-hosted"}(n))}),[n]);var E,C,k=function(){var e=Object(b.a)(O.a.mark((function e(t){var n;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break}return e.abrupt("return");case 2:return l(!0),e.prev=3,e.next=6,fetch("/wp-admin/admin-ajax.php",{method:"POST",credentials:"same-origin",headers:{"Content-Type":"application/x-www-form-urlencoded","Cache-Control":"no-cache"},body:new URLSearchParams({action:"presto_get_media_attributes",_wpnonce:window.et_fb_options.et_admin_load_nonce,id:t})}).then((function(e){return e.json()}));case 6:n=e.sent,c(n.data);case 8:return e.prev=8,l(!1),e.finish(8);case 11:case"end":return e.stop()}}),e,null,[[3,,8,11]])})));return function(t){return e.apply(this,arguments)}}();return u?Object(T.b)("div",{className:"et-fb-preloader et-fb-preloader__loading"},Object(T.b)("div",{className:"et-fb-loader"})):null!=a&&a.id?(n=n||a.src,"bunny"!==(null==a?void 0:a.provider)||"self-hosted"!==m&&"bunny"!==m?Object(T.b)("div",{css:Object(T.a)(L||(L=Object(d.a)(["\n          ","\n        "])),null==a?void 0:a.styles)},Object(T.b)(I,{key:_,video_id:a.id,preset:a.preset,src:n,chapters:a.chapters,tracks:a.tracks,branding:a.branding,blockAttributes:a.blockAttributes,poster:null==a||null===(E=a.blockAttributes)||void 0===E?void 0:E.poster,mediaTitle:null==a||null===(C=a.blockAttributes)||void 0===C?void 0:C.title,config:a.config,skin:a.skin,analytics:a.analytics,automations:a.automations,provider:m||(null==a?void 0:a.provider),provider_video_id:a.provider_video_id,youtube:a.youtube})):Object(T.b)("presto-video-curtain-ui",null,Object(T.b)("span",null,"Bunny.net videos cannot be previewed in the DIVI editor due to DIVI iframe having no referrer."),Object(T.b)("presto-player-button",{full:!0,type:"primary",target:"_blank",href:"https://prestoplayer.com/docs/bunny-net-videos-not-showing-in-divi-editor"},"Learn More"))):"Choose Media Item"};function U(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Object(u.a)(e);if(t){var o=Object(u.a)(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Object(s.a)(this,n)}}var B=wp.i18n.__,M=function(e){Object(i.a)(n,e);var t=U(n);function n(e){var r;return Object(a.a)(this,n),(r=t.call(this,e)).state={videos:[]},r}return Object(c.a)(n,[{key:"render",value:function(){var e=this.props.dynamic.url_override;return this.props.video_id?f.a.createElement(A,{id:this.props.video_id,src:e&&e.value&&e.value}):f.a.createElement("presto-video-curtain-ui",null,f.a.createElement("span",null,B("Please select media.","presto-player")))}}]),n}(p.Component);Object(l.a)(M,"slug","prpl_presto_player");var z=[M],J=n(10),F=n(16),Q=n(15),Z=n(48),$=n(46),q=n(47),G=n.n(q);function H(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function K(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?H(Object(n),!0).forEach((function(t){Object(l.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):H(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function W(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Object(u.a)(e);if(t){var o=Object(u.a)(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Object(s.a)(this,n)}}var X=wp.i18n.__,Y=function(e){Object(i.a)(n,e);var t=W(n);function n(){var e;Object(a.a)(this,n);for(var r=arguments.length,o=new Array(r),c=0;c<r;c++)o[c]=arguments[c];return e=t.call.apply(t,[this].concat(o)),Object(l.a)(Object(J.a)(e),"createEmotionCacheCustom",(function(e){return Object(F.a)({nonce:e,key:"custom-select-style",container:this.props.container})})),Object(l.a)(Object(J.a)(e),"createEmotionCache",Object(Q.a)(e.createEmotionCacheCustom)),e}return Object(c.a)(n)}(Z.a),ee=function(e){Object(i.a)(n,e);var t=W(n);function n(e){var r;Object(a.a)(this,n),r=t.call(this,e),Object(l.a)(Object(J.a)(r),"fetchVideos",(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return fetch("/wp-admin/admin-ajax.php",{method:"POST",credentials:"same-origin",headers:{"Content-Type":"application/x-www-form-urlencoded","Cache-Control":"no-cache"},body:new URLSearchParams({action:"presto_fetch_videos",search:e})}).then((function(e){return e.json()})).then((function(e){return e.data||[]}))})),Object(l.a)(Object(J.a)(r),"fetchVideo",(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return e?fetch("/wp-admin/admin-ajax.php",{method:"POST",credentials:"same-origin",headers:{"Content-Type":"application/x-www-form-urlencoded","Cache-Control":"no-cache"},body:new URLSearchParams({action:"presto_fetch_videos",post_id:e})}).then((function(e){return e.json()})).then((function(e){return e.data||[]})):[]})),Object(l.a)(Object(J.a)(r),"loadVideos",function(){var e=Object(b.a)(O.a.mark((function e(t){var n,o,a,c;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=K({searchTerm:"",postId:""},t),e.next=3,Promise.all([r.fetchVideo(t.postId),r.fetchVideos(t.searchTerm)]);case 3:return n=e.sent,o=Object(v.a)(n,2),a=o[0],c=o[1],a[0]&&!c.find((function(e){return e.ID===a[0].ID}))&&c.push(a[0]),c=c.map((function(e){return{label:e.post_title||X("Untitled","presto-player"),value:e.ID}})),r.setState({videos:c}),e.abrupt("return",c);case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),Object(l.a)(Object(J.a)(r),"_onChange",(function(e){r.props._onChange(r.props.name,e.value)})),Object(l.a)(Object(J.a)(r),"_onEditVideoClick",(function(){var e=r.props.value;e&&window.open("/wp-admin/post.php?post=".concat(e,"&action=edit"),"_blank").focus()})),Object(l.a)(Object(J.a)(r),"_onCreateVideoClick",(function(){window.open("/wp-admin/post-new.php?post_type=pp_video_block","_blank").focus()})),Object(l.a)(Object(J.a)(r),"currentVideoLabel",(function(){if(!r.state.videos)return"";var e=(r.state.videos||[]).find((function(e){return e.value===parseInt(r.props.value)}));return e?e.label:""})),r.state={videos:[]};return r.debouncedLoadVideos=G()((function(e){return r.loadVideos({searchTerm:e})}),500,{leading:!0}),r}return Object(c.a)(n,[{key:"render",value:function(){var e=this;return f.a.createElement("div",{className:"presto-player-divi-editor"},f.a.createElement("ul",{className:"presto-player-divi-editor__inputs"},f.a.createElement("li",null,f.a.createElement(Y,{container:window.parent.document.body},f.a.createElement($.a,{id:"prpd_video_selector-".concat(this.props.name),className:"prpd_video_selector",cacheOptions:!0,defaultOptions:!0,name:this.props.name,value:{value:this.props.value,label:this.currentVideoLabel()},onChange:this._onChange,loadOptions:function(t){return e.debouncedLoadVideos(t)}}))),f.a.createElement("li",null,f.a.createElement("label",null,X("Video Options","presto-player")),f.a.createElement("button",{type:"button",onClick:this._onEditVideoClick},X("Edit Video","presto-player"))),f.a.createElement("li",null,f.a.createElement("label",null,X("New Video","presto-player")),f.a.createElement("button",{type:"button",onClick:this._onCreateVideoClick},X("Create Video","presto-player")))))}}]),n}(p.Component);Object(l.a)(ee,"slug","prpl_video_selector");var te=[ee];o()(window).on("et_builder_api_ready",(function(e,t){t.registerModules(z),t.registerModalFields(te)}))}},[[51,1,2]]]);
//# sourceMappingURL=admin-ca945bf9.js.map